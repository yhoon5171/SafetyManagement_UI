{"ast":null,"code":"const Blockchain = {\n  getBlockByNumber(blockNumber, provider, callback) {\n    const params = [blockNumber, true];\n    provider.send({\n      jsonrpc: \"2.0\",\n      method: \"eth_getBlockByNumber\",\n      params,\n      id: Date.now()\n    }, callback);\n  },\n\n  getBlockByHash(blockHash, provider, callback) {\n    const params = [blockHash, true];\n    provider.send({\n      jsonrpc: \"2.0\",\n      method: \"eth_getBlockByHash\",\n      params,\n      id: Date.now()\n    }, callback);\n  },\n\n  parse(uri) {\n    const parsed = {};\n    if (uri.indexOf(\"blockchain://\") !== 0) return parsed;\n    const cleanUri = uri.replace(\"blockchain://\", \"\");\n    const pieces = cleanUri.split(\"/block/\");\n    parsed.genesis_hash = `0x${pieces[0]}`;\n    parsed.block_hash = `0x${pieces[1]}`;\n    return parsed;\n  },\n\n  asURI(provider, callback) {\n    let genesis, latest;\n    this.getBlockByNumber(\"0x0\", provider, (err, _ref) => {\n      let {\n        result\n      } = _ref;\n      if (err) return callback(err);\n      genesis = result;\n      this.getBlockByNumber(\"latest\", provider, (err, _ref2) => {\n        let {\n          result\n        } = _ref2;\n        if (err) return callback(err);\n        latest = result;\n        const url = `blockchain://${genesis.hash.replace(\"0x\", \"\")}/block/${latest.hash.replace(\"0x\", \"\")}`;\n        callback(null, url);\n      });\n    });\n  },\n\n  matches(uri, provider, callback) {\n    const parsedUri = this.parse(uri);\n    const expected_genesis = parsedUri.genesis_hash;\n    const expected_block = parsedUri.block_hash;\n    this.getBlockByNumber(\"0x0\", provider, (err, _ref3) => {\n      let {\n        result\n      } = _ref3;\n      if (err) return callback(err);\n      const block = result;\n      if (block.hash !== expected_genesis) return callback(null, false);\n      this.getBlockByHash(expected_block, provider, (err, _ref4) => {\n        let {\n          result\n        } = _ref4;\n        // Treat an error as if the block didn't exist. This is because\n        // some clients respond differently.\n        const block = result;\n\n        if (err || block == null) {\n          return callback(null, false);\n        }\n\n        callback(null, true);\n      });\n    });\n  }\n\n};\nmodule.exports = Blockchain;","map":{"version":3,"names":["Blockchain","getBlockByNumber","blockNumber","provider","callback","params","send","jsonrpc","method","id","Date","now","getBlockByHash","blockHash","parse","uri","parsed","indexOf","cleanUri","replace","pieces","split","genesis_hash","block_hash","asURI","genesis","latest","err","result","url","hash","matches","parsedUri","expected_genesis","expected_block","block","module","exports"],"sources":["D:/BlockchainSafetyManagement/client/node_modules/@truffle/blockchain-utils/index.js"],"sourcesContent":["const Blockchain = {\r\n  getBlockByNumber(blockNumber, provider, callback) {\r\n    const params = [blockNumber, true];\r\n    provider.send(\r\n      {\r\n        jsonrpc: \"2.0\",\r\n        method: \"eth_getBlockByNumber\",\r\n        params,\r\n        id: Date.now()\r\n      },\r\n      callback\r\n    );\r\n  },\r\n\r\n  getBlockByHash(blockHash, provider, callback) {\r\n    const params = [blockHash, true];\r\n    provider.send(\r\n      {\r\n        jsonrpc: \"2.0\",\r\n        method: \"eth_getBlockByHash\",\r\n        params,\r\n        id: Date.now()\r\n      },\r\n      callback\r\n    );\r\n  },\r\n\r\n  parse(uri) {\r\n    const parsed = {};\r\n    if (uri.indexOf(\"blockchain://\") !== 0) return parsed;\r\n\r\n    const cleanUri = uri.replace(\"blockchain://\", \"\");\r\n\r\n    const pieces = cleanUri.split(\"/block/\");\r\n\r\n    parsed.genesis_hash = `0x${pieces[0]}`;\r\n    parsed.block_hash = `0x${pieces[1]}`;\r\n\r\n    return parsed;\r\n  },\r\n\r\n  asURI(provider, callback) {\r\n    let genesis, latest;\r\n\r\n    this.getBlockByNumber(\"0x0\", provider, (err, { result }) => {\r\n      if (err) return callback(err);\r\n      genesis = result;\r\n\r\n      this.getBlockByNumber(\"latest\", provider, (err, { result }) => {\r\n        if (err) return callback(err);\r\n        latest = result;\r\n        const url = `blockchain://${genesis.hash.replace(\r\n          \"0x\",\r\n          \"\"\r\n        )}/block/${latest.hash.replace(\"0x\", \"\")}`;\r\n        callback(null, url);\r\n      });\r\n    });\r\n  },\r\n\r\n  matches(uri, provider, callback) {\r\n    const parsedUri = this.parse(uri);\r\n\r\n    const expected_genesis = parsedUri.genesis_hash;\r\n    const expected_block = parsedUri.block_hash;\r\n\r\n    this.getBlockByNumber(\"0x0\", provider, (err, { result }) => {\r\n      if (err) return callback(err);\r\n      const block = result;\r\n      if (block.hash !== expected_genesis) return callback(null, false);\r\n\r\n      this.getBlockByHash(expected_block, provider, (err, { result }) => {\r\n        // Treat an error as if the block didn't exist. This is because\r\n        // some clients respond differently.\r\n        const block = result;\r\n        if (err || block == null) {\r\n          return callback(null, false);\r\n        }\r\n\r\n        callback(null, true);\r\n      });\r\n    });\r\n  }\r\n};\r\n\r\nmodule.exports = Blockchain;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}