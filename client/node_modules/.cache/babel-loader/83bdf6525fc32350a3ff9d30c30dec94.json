{"ast":null,"code":"var MODES = require('./modes');\n\nvar AuthCipher = require('./authCipher');\n\nvar Buffer = require('safe-buffer').Buffer;\n\nvar StreamCipher = require('./streamCipher');\n\nvar Transform = require('cipher-base');\n\nvar aes = require('./aes');\n\nvar ebtk = require('evp_bytestokey');\n\nvar inherits = require('inherits');\n\nfunction Cipher(mode, key, iv) {\n  Transform.call(this);\n  this._cache = new Splitter();\n  this._cipher = new aes.AES(key);\n  this._prev = Buffer.from(iv);\n  this._mode = mode;\n  this._autopadding = true;\n}\n\ninherits(Cipher, Transform);\n\nCipher.prototype._update = function (data) {\n  this._cache.add(data);\n\n  var chunk;\n  var thing;\n  var out = [];\n\n  while (chunk = this._cache.get()) {\n    thing = this._mode.encrypt(this, chunk);\n    out.push(thing);\n  }\n\n  return Buffer.concat(out);\n};\n\nvar PADDING = Buffer.alloc(16, 0x10);\n\nCipher.prototype._final = function () {\n  var chunk = this._cache.flush();\n\n  if (this._autopadding) {\n    chunk = this._mode.encrypt(this, chunk);\n\n    this._cipher.scrub();\n\n    return chunk;\n  }\n\n  if (!chunk.equals(PADDING)) {\n    this._cipher.scrub();\n\n    throw new Error('data not multiple of block length');\n  }\n};\n\nCipher.prototype.setAutoPadding = function (setTo) {\n  this._autopadding = !!setTo;\n  return this;\n};\n\nfunction Splitter() {\n  this.cache = Buffer.allocUnsafe(0);\n}\n\nSplitter.prototype.add = function (data) {\n  this.cache = Buffer.concat([this.cache, data]);\n};\n\nSplitter.prototype.get = function () {\n  if (this.cache.length > 15) {\n    var out = this.cache.slice(0, 16);\n    this.cache = this.cache.slice(16);\n    return out;\n  }\n\n  return null;\n};\n\nSplitter.prototype.flush = function () {\n  var len = 16 - this.cache.length;\n  var padBuff = Buffer.allocUnsafe(len);\n  var i = -1;\n\n  while (++i < len) {\n    padBuff.writeUInt8(len, i);\n  }\n\n  return Buffer.concat([this.cache, padBuff]);\n};\n\nfunction createCipheriv(suite, password, iv) {\n  var config = MODES[suite.toLowerCase()];\n  if (!config) throw new TypeError('invalid suite type');\n  if (typeof password === 'string') password = Buffer.from(password);\n  if (password.length !== config.key / 8) throw new TypeError('invalid key length ' + password.length);\n  if (typeof iv === 'string') iv = Buffer.from(iv);\n  if (config.mode !== 'GCM' && iv.length !== config.iv) throw new TypeError('invalid iv length ' + iv.length);\n\n  if (config.type === 'stream') {\n    return new StreamCipher(config.module, password, iv);\n  } else if (config.type === 'auth') {\n    return new AuthCipher(config.module, password, iv);\n  }\n\n  return new Cipher(config.module, password, iv);\n}\n\nfunction createCipher(suite, password) {\n  var config = MODES[suite.toLowerCase()];\n  if (!config) throw new TypeError('invalid suite type');\n  var keys = ebtk(password, false, config.key, config.iv);\n  return createCipheriv(suite, keys.key, keys.iv);\n}\n\nexports.createCipheriv = createCipheriv;\nexports.createCipher = createCipher;","map":{"version":3,"names":["MODES","require","AuthCipher","Buffer","StreamCipher","Transform","aes","ebtk","inherits","Cipher","mode","key","iv","call","_cache","Splitter","_cipher","AES","_prev","from","_mode","_autopadding","prototype","_update","data","add","chunk","thing","out","get","encrypt","push","concat","PADDING","alloc","_final","flush","scrub","equals","Error","setAutoPadding","setTo","cache","allocUnsafe","length","slice","len","padBuff","i","writeUInt8","createCipheriv","suite","password","config","toLowerCase","TypeError","type","module","createCipher","keys","exports"],"sources":["C:/Users/mcnl/Desktop/gong/BlockchainSafetyManagement/client/node_modules/browserify-aes/encrypter.js"],"sourcesContent":["var MODES = require('./modes')\r\nvar AuthCipher = require('./authCipher')\r\nvar Buffer = require('safe-buffer').Buffer\r\nvar StreamCipher = require('./streamCipher')\r\nvar Transform = require('cipher-base')\r\nvar aes = require('./aes')\r\nvar ebtk = require('evp_bytestokey')\r\nvar inherits = require('inherits')\r\n\r\nfunction Cipher (mode, key, iv) {\r\n  Transform.call(this)\r\n\r\n  this._cache = new Splitter()\r\n  this._cipher = new aes.AES(key)\r\n  this._prev = Buffer.from(iv)\r\n  this._mode = mode\r\n  this._autopadding = true\r\n}\r\n\r\ninherits(Cipher, Transform)\r\n\r\nCipher.prototype._update = function (data) {\r\n  this._cache.add(data)\r\n  var chunk\r\n  var thing\r\n  var out = []\r\n\r\n  while ((chunk = this._cache.get())) {\r\n    thing = this._mode.encrypt(this, chunk)\r\n    out.push(thing)\r\n  }\r\n\r\n  return Buffer.concat(out)\r\n}\r\n\r\nvar PADDING = Buffer.alloc(16, 0x10)\r\n\r\nCipher.prototype._final = function () {\r\n  var chunk = this._cache.flush()\r\n  if (this._autopadding) {\r\n    chunk = this._mode.encrypt(this, chunk)\r\n    this._cipher.scrub()\r\n    return chunk\r\n  }\r\n\r\n  if (!chunk.equals(PADDING)) {\r\n    this._cipher.scrub()\r\n    throw new Error('data not multiple of block length')\r\n  }\r\n}\r\n\r\nCipher.prototype.setAutoPadding = function (setTo) {\r\n  this._autopadding = !!setTo\r\n  return this\r\n}\r\n\r\nfunction Splitter () {\r\n  this.cache = Buffer.allocUnsafe(0)\r\n}\r\n\r\nSplitter.prototype.add = function (data) {\r\n  this.cache = Buffer.concat([this.cache, data])\r\n}\r\n\r\nSplitter.prototype.get = function () {\r\n  if (this.cache.length > 15) {\r\n    var out = this.cache.slice(0, 16)\r\n    this.cache = this.cache.slice(16)\r\n    return out\r\n  }\r\n  return null\r\n}\r\n\r\nSplitter.prototype.flush = function () {\r\n  var len = 16 - this.cache.length\r\n  var padBuff = Buffer.allocUnsafe(len)\r\n\r\n  var i = -1\r\n  while (++i < len) {\r\n    padBuff.writeUInt8(len, i)\r\n  }\r\n\r\n  return Buffer.concat([this.cache, padBuff])\r\n}\r\n\r\nfunction createCipheriv (suite, password, iv) {\r\n  var config = MODES[suite.toLowerCase()]\r\n  if (!config) throw new TypeError('invalid suite type')\r\n\r\n  if (typeof password === 'string') password = Buffer.from(password)\r\n  if (password.length !== config.key / 8) throw new TypeError('invalid key length ' + password.length)\r\n\r\n  if (typeof iv === 'string') iv = Buffer.from(iv)\r\n  if (config.mode !== 'GCM' && iv.length !== config.iv) throw new TypeError('invalid iv length ' + iv.length)\r\n\r\n  if (config.type === 'stream') {\r\n    return new StreamCipher(config.module, password, iv)\r\n  } else if (config.type === 'auth') {\r\n    return new AuthCipher(config.module, password, iv)\r\n  }\r\n\r\n  return new Cipher(config.module, password, iv)\r\n}\r\n\r\nfunction createCipher (suite, password) {\r\n  var config = MODES[suite.toLowerCase()]\r\n  if (!config) throw new TypeError('invalid suite type')\r\n\r\n  var keys = ebtk(password, false, config.key, config.iv)\r\n  return createCipheriv(suite, keys.key, keys.iv)\r\n}\r\n\r\nexports.createCipheriv = createCipheriv\r\nexports.createCipher = createCipher\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}