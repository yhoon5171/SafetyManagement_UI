{"ast":null,"code":"/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n\n/** @file WebsocketProvider.js\n * @authors:\n *   Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2017\n */\n\"use strict\";\n\nvar _ = require('underscore');\n\nvar errors = require('web3-core-helpers').errors;\n\nvar Ws = require('websocket').w3cwebsocket;\n\nvar isNode = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\nvar _btoa = null;\nvar parseURL = null;\n\nif (isNode) {\n  _btoa = function (str) {\n    return Buffer.from(str).toString('base64');\n  };\n\n  var url = require('url');\n\n  if (url.URL) {\n    // Use the new Node 6+ API for parsing URLs that supports username/password\n    var newURL = url.URL;\n\n    parseURL = function (url) {\n      return new newURL(url);\n    };\n  } else {\n    // Web3 supports Node.js 5, so fall back to the legacy URL API if necessary\n    parseURL = require('url').parse;\n  }\n} else {\n  _btoa = btoa;\n\n  parseURL = function (url) {\n    return new URL(url);\n  };\n} // Default connection ws://localhost:8546\n\n\nvar WebsocketProvider = function WebsocketProvider(url, options) {\n  if (!Ws) {\n    throw new Error('websocket is not available');\n  }\n\n  var _this = this;\n\n  this.responseCallbacks = {};\n  this.notificationCallbacks = [];\n  options = options || {};\n  this._customTimeout = options.timeout; // The w3cwebsocket implementation does not support Basic Auth\n  // username/password in the URL. So generate the basic auth header, and\n  // pass through with any additional headers supplied in constructor\n\n  var parsedURL = parseURL(url);\n  var headers = options.headers || {};\n  var protocol = options.protocol || undefined;\n\n  if (parsedURL.username && parsedURL.password) {\n    headers.authorization = 'Basic ' + _btoa(parsedURL.username + ':' + parsedURL.password);\n  } // Allow a custom client configuration\n\n\n  var clientConfig = options.clientConfig || undefined; // Allow a custom request options\n  // https://github.com/theturtle32/WebSocket-Node/blob/master/docs/WebSocketClient.md#connectrequesturl-requestedprotocols-origin-headers-requestoptions\n\n  var requestOptions = options.requestOptions || undefined; // When all node core implementations that do not have the\n  // WHATWG compatible URL parser go out of service this line can be removed.\n\n  if (parsedURL.auth) {\n    headers.authorization = 'Basic ' + _btoa(parsedURL.auth);\n  }\n\n  this.connection = new Ws(url, protocol, undefined, headers, requestOptions, clientConfig);\n  this.addDefaultEvents(); // LISTEN FOR CONNECTION RESPONSES\n\n  this.connection.onmessage = function (e) {\n    /*jshint maxcomplexity: 6 */\n    var data = typeof e.data === 'string' ? e.data : '';\n\n    _this._parseResponse(data).forEach(function (result) {\n      var id = null; // get the id which matches the returned id\n\n      if (_.isArray(result)) {\n        result.forEach(function (load) {\n          if (_this.responseCallbacks[load.id]) id = load.id;\n        });\n      } else {\n        id = result.id;\n      } // notification\n\n\n      if (!id && result && result.method && result.method.indexOf('_subscription') !== -1) {\n        _this.notificationCallbacks.forEach(function (callback) {\n          if (_.isFunction(callback)) callback(result);\n        }); // fire the callback\n\n      } else if (_this.responseCallbacks[id]) {\n        _this.responseCallbacks[id](null, result);\n\n        delete _this.responseCallbacks[id];\n      }\n    });\n  }; // make property `connected` which will return the current connection status\n\n\n  Object.defineProperty(this, 'connected', {\n    get: function () {\n      return this.connection && this.connection.readyState === this.connection.OPEN;\n    },\n    enumerable: true\n  });\n};\n/**\n Will add the error and end event to timeout existing calls\n\n @method addDefaultEvents\n */\n\n\nWebsocketProvider.prototype.addDefaultEvents = function () {\n  var _this = this;\n\n  this.connection.onerror = function () {\n    _this._timeout();\n  };\n\n  this.connection.onclose = function () {\n    _this._timeout(); // reset all requests and callbacks\n\n\n    _this.reset();\n  }; // this.connection.on('timeout', function(){\n  //     _this._timeout();\n  // });\n\n};\n/**\n Will parse the response and make an array out of it.\n\n @method _parseResponse\n @param {String} data\n */\n\n\nWebsocketProvider.prototype._parseResponse = function (data) {\n  var _this = this,\n      returnValues = []; // DE-CHUNKER\n\n\n  var dechunkedData = data.replace(/\\}[\\n\\r]?\\{/g, '}|--|{') // }{\n  .replace(/\\}\\][\\n\\r]?\\[\\{/g, '}]|--|[{') // }][{\n  .replace(/\\}[\\n\\r]?\\[\\{/g, '}|--|[{') // }[{\n  .replace(/\\}\\][\\n\\r]?\\{/g, '}]|--|{') // }]{\n  .split('|--|');\n  dechunkedData.forEach(function (data) {\n    // prepend the last chunk\n    if (_this.lastChunk) data = _this.lastChunk + data;\n    var result = null;\n\n    try {\n      result = JSON.parse(data);\n    } catch (e) {\n      _this.lastChunk = data; // start timeout to cancel all requests\n\n      clearTimeout(_this.lastChunkTimeout);\n      _this.lastChunkTimeout = setTimeout(function () {\n        _this._timeout();\n\n        throw errors.InvalidResponse(data);\n      }, 1000 * 15);\n      return;\n    } // cancel timeout and set chunk to null\n\n\n    clearTimeout(_this.lastChunkTimeout);\n    _this.lastChunk = null;\n    if (result) returnValues.push(result);\n  });\n  return returnValues;\n};\n/**\n Adds a callback to the responseCallbacks object,\n which will be called if a response matching the response Id will arrive.\n\n @method _addResponseCallback\n */\n\n\nWebsocketProvider.prototype._addResponseCallback = function (payload, callback) {\n  var id = payload.id || payload[0].id;\n  var method = payload.method || payload[0].method;\n  this.responseCallbacks[id] = callback;\n  this.responseCallbacks[id].method = method;\n\n  var _this = this; // schedule triggering the error response if a custom timeout is set\n\n\n  if (this._customTimeout) {\n    setTimeout(function () {\n      if (_this.responseCallbacks[id]) {\n        _this.responseCallbacks[id](errors.ConnectionTimeout(_this._customTimeout));\n\n        delete _this.responseCallbacks[id];\n      }\n    }, this._customTimeout);\n  }\n};\n/**\n Timeout all requests when the end/error event is fired\n\n @method _timeout\n */\n\n\nWebsocketProvider.prototype._timeout = function () {\n  for (var key in this.responseCallbacks) {\n    if (this.responseCallbacks.hasOwnProperty(key)) {\n      this.responseCallbacks[key](errors.InvalidConnection('on WS'));\n      delete this.responseCallbacks[key];\n    }\n  }\n};\n\nWebsocketProvider.prototype.send = function (payload, callback) {\n  var _this = this;\n\n  if (this.connection.readyState === this.connection.CONNECTING) {\n    setTimeout(function () {\n      _this.send(payload, callback);\n    }, 10);\n    return;\n  } // try reconnect, when connection is gone\n  // if(!this.connection.writable)\n  //     this.connection.connect({url: this.url});\n\n\n  if (this.connection.readyState !== this.connection.OPEN) {\n    console.error('connection not open on send()');\n\n    if (typeof this.connection.onerror === 'function') {\n      this.connection.onerror(new Error('connection not open'));\n    } else {\n      console.error('no error callback');\n    }\n\n    callback(new Error('connection not open'));\n    return;\n  }\n\n  this.connection.send(JSON.stringify(payload));\n\n  this._addResponseCallback(payload, callback);\n};\n/**\n Subscribes to provider events.provider\n\n @method on\n @param {String} type    'notifcation', 'connect', 'error', 'end' or 'data'\n @param {Function} callback   the callback to call\n */\n\n\nWebsocketProvider.prototype.on = function (type, callback) {\n  if (typeof callback !== 'function') throw new Error('The second parameter callback must be a function.');\n\n  switch (type) {\n    case 'data':\n      this.notificationCallbacks.push(callback);\n      break;\n\n    case 'connect':\n      this.connection.onopen = callback;\n      break;\n\n    case 'end':\n      this.connection.onclose = callback;\n      break;\n\n    case 'error':\n      this.connection.onerror = callback;\n      break;\n    // default:\n    //     this.connection.on(type, callback);\n    //     break;\n  }\n}; // TODO add once\n\n/**\n Removes event listener\n\n @method removeListener\n @param {String} type    'notifcation', 'connect', 'error', 'end' or 'data'\n @param {Function} callback   the callback to call\n */\n\n\nWebsocketProvider.prototype.removeListener = function (type, callback) {\n  var _this = this;\n\n  switch (type) {\n    case 'data':\n      this.notificationCallbacks.forEach(function (cb, index) {\n        if (cb === callback) _this.notificationCallbacks.splice(index, 1);\n      });\n      break;\n    // TODO remvoving connect missing\n    // default:\n    //     this.connection.removeListener(type, callback);\n    //     break;\n  }\n};\n/**\n Removes all event listeners\n\n @method removeAllListeners\n @param {String} type    'notifcation', 'connect', 'error', 'end' or 'data'\n */\n\n\nWebsocketProvider.prototype.removeAllListeners = function (type) {\n  switch (type) {\n    case 'data':\n      this.notificationCallbacks = [];\n      break;\n    // TODO remvoving connect properly missing\n\n    case 'connect':\n      this.connection.onopen = null;\n      break;\n\n    case 'end':\n      this.connection.onclose = null;\n      break;\n\n    case 'error':\n      this.connection.onerror = null;\n      break;\n\n    default:\n      // this.connection.removeAllListeners(type);\n      break;\n  }\n};\n/**\n Resets the providers, clears all callbacks\n\n @method reset\n */\n\n\nWebsocketProvider.prototype.reset = function () {\n  this._timeout();\n\n  this.notificationCallbacks = []; // this.connection.removeAllListeners('error');\n  // this.connection.removeAllListeners('end');\n  // this.connection.removeAllListeners('timeout');\n\n  this.addDefaultEvents();\n};\n\nWebsocketProvider.prototype.disconnect = function () {\n  if (this.connection) {\n    this.connection.close();\n  }\n};\n\nmodule.exports = WebsocketProvider;","map":{"version":3,"names":["_","require","errors","Ws","w3cwebsocket","isNode","Object","prototype","toString","call","process","_btoa","parseURL","str","Buffer","from","url","URL","newURL","parse","btoa","WebsocketProvider","options","Error","_this","responseCallbacks","notificationCallbacks","_customTimeout","timeout","parsedURL","headers","protocol","undefined","username","password","authorization","clientConfig","requestOptions","auth","connection","addDefaultEvents","onmessage","e","data","_parseResponse","forEach","result","id","isArray","load","method","indexOf","callback","isFunction","defineProperty","get","readyState","OPEN","enumerable","onerror","_timeout","onclose","reset","returnValues","dechunkedData","replace","split","lastChunk","JSON","clearTimeout","lastChunkTimeout","setTimeout","InvalidResponse","push","_addResponseCallback","payload","ConnectionTimeout","key","hasOwnProperty","InvalidConnection","send","CONNECTING","console","error","stringify","on","type","onopen","removeListener","cb","index","splice","removeAllListeners","disconnect","close","module","exports"],"sources":["D:/공프기/REACT/client/node_modules/truffle-interface-adapter/node_modules/web3-providers-ws/src/index.js"],"sourcesContent":["/*\n This file is part of web3.js.\n\n web3.js is free software: you can redistribute it and/or modify\n it under the terms of the GNU Lesser General Public License as published by\n the Free Software Foundation, either version 3 of the License, or\n (at your option) any later version.\n\n web3.js is distributed in the hope that it will be useful,\n but WITHOUT ANY WARRANTY; without even the implied warranty of\n MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n GNU Lesser General Public License for more details.\n\n You should have received a copy of the GNU Lesser General Public License\n along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n */\n/** @file WebsocketProvider.js\n * @authors:\n *   Fabian Vogelsteller <fabian@ethereum.org>\n * @date 2017\n */\n\n\"use strict\";\n\nvar _ = require('underscore');\nvar errors = require('web3-core-helpers').errors;\nvar Ws = require('websocket').w3cwebsocket;\n\nvar isNode = Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]';\n\nvar _btoa = null;\nvar parseURL = null;\nif (isNode) {\n    _btoa = function(str) {\n        return Buffer.from(str).toString('base64');\n    };\n    var url = require('url');\n    if (url.URL) {\n        // Use the new Node 6+ API for parsing URLs that supports username/password\n        var newURL = url.URL;\n        parseURL = function(url) {\n            return new newURL(url);\n        };\n    }\n    else {\n        // Web3 supports Node.js 5, so fall back to the legacy URL API if necessary\n        parseURL = require('url').parse;\n    }\n} else {\n    _btoa = btoa;\n    parseURL = function(url) {\n        return new URL(url);\n    };\n}\n// Default connection ws://localhost:8546\n\n\n\n\nvar WebsocketProvider = function WebsocketProvider(url, options)  {\n    if (!Ws) {\n        throw new Error('websocket is not available');\n    }\n\n    var _this = this;\n    this.responseCallbacks = {};\n    this.notificationCallbacks = [];\n\n    options = options || {};\n    this._customTimeout = options.timeout;\n\n    // The w3cwebsocket implementation does not support Basic Auth\n    // username/password in the URL. So generate the basic auth header, and\n    // pass through with any additional headers supplied in constructor\n    var parsedURL = parseURL(url);\n    var headers = options.headers || {};\n    var protocol = options.protocol || undefined;\n    if (parsedURL.username && parsedURL.password) {\n        headers.authorization = 'Basic ' + _btoa(parsedURL.username + ':' + parsedURL.password);\n    }\n\n    // Allow a custom client configuration\n    var clientConfig = options.clientConfig || undefined;\n    \n    // Allow a custom request options\n    // https://github.com/theturtle32/WebSocket-Node/blob/master/docs/WebSocketClient.md#connectrequesturl-requestedprotocols-origin-headers-requestoptions\n    var requestOptions = options.requestOptions || undefined;\n\n    // When all node core implementations that do not have the\n    // WHATWG compatible URL parser go out of service this line can be removed.\n    if (parsedURL.auth) {\n        headers.authorization = 'Basic ' + _btoa(parsedURL.auth);\n    }\n    this.connection = new Ws(url, protocol, undefined, headers, requestOptions, clientConfig);\n\n    this.addDefaultEvents();\n\n\n    // LISTEN FOR CONNECTION RESPONSES\n    this.connection.onmessage = function(e) {\n        /*jshint maxcomplexity: 6 */\n        var data = (typeof e.data === 'string') ? e.data : '';\n\n        _this._parseResponse(data).forEach(function(result){\n\n            var id = null;\n\n            // get the id which matches the returned id\n            if(_.isArray(result)) {\n                result.forEach(function(load){\n                    if(_this.responseCallbacks[load.id])\n                        id = load.id;\n                });\n            } else {\n                id = result.id;\n            }\n\n            // notification\n            if(!id && result && result.method && result.method.indexOf('_subscription') !== -1) {\n                _this.notificationCallbacks.forEach(function(callback){\n                    if(_.isFunction(callback))\n                        callback(result);\n                });\n\n                // fire the callback\n            } else if(_this.responseCallbacks[id]) {\n                _this.responseCallbacks[id](null, result);\n                delete _this.responseCallbacks[id];\n            }\n        });\n    };\n\n    // make property `connected` which will return the current connection status\n    Object.defineProperty(this, 'connected', {\n      get: function () {\n        return this.connection && this.connection.readyState === this.connection.OPEN;\n      },\n      enumerable: true,\n  });\n};\n\n/**\n Will add the error and end event to timeout existing calls\n\n @method addDefaultEvents\n */\nWebsocketProvider.prototype.addDefaultEvents = function(){\n    var _this = this;\n\n    this.connection.onerror = function(){\n        _this._timeout();\n    };\n\n    this.connection.onclose = function(){\n        _this._timeout();\n\n        // reset all requests and callbacks\n        _this.reset();\n    };\n\n    // this.connection.on('timeout', function(){\n    //     _this._timeout();\n    // });\n};\n\n/**\n Will parse the response and make an array out of it.\n\n @method _parseResponse\n @param {String} data\n */\nWebsocketProvider.prototype._parseResponse = function(data) {\n    var _this = this,\n        returnValues = [];\n\n    // DE-CHUNKER\n    var dechunkedData = data\n        .replace(/\\}[\\n\\r]?\\{/g,'}|--|{') // }{\n        .replace(/\\}\\][\\n\\r]?\\[\\{/g,'}]|--|[{') // }][{\n        .replace(/\\}[\\n\\r]?\\[\\{/g,'}|--|[{') // }[{\n        .replace(/\\}\\][\\n\\r]?\\{/g,'}]|--|{') // }]{\n        .split('|--|');\n\n    dechunkedData.forEach(function(data){\n\n        // prepend the last chunk\n        if(_this.lastChunk)\n            data = _this.lastChunk + data;\n\n        var result = null;\n\n        try {\n            result = JSON.parse(data);\n\n        } catch(e) {\n\n            _this.lastChunk = data;\n\n            // start timeout to cancel all requests\n            clearTimeout(_this.lastChunkTimeout);\n            _this.lastChunkTimeout = setTimeout(function(){\n                _this._timeout();\n                throw errors.InvalidResponse(data);\n            }, 1000 * 15);\n\n            return;\n        }\n\n        // cancel timeout and set chunk to null\n        clearTimeout(_this.lastChunkTimeout);\n        _this.lastChunk = null;\n\n        if(result)\n            returnValues.push(result);\n    });\n\n    return returnValues;\n};\n\n\n/**\n Adds a callback to the responseCallbacks object,\n which will be called if a response matching the response Id will arrive.\n\n @method _addResponseCallback\n */\nWebsocketProvider.prototype._addResponseCallback = function(payload, callback) {\n    var id = payload.id || payload[0].id;\n    var method = payload.method || payload[0].method;\n\n    this.responseCallbacks[id] = callback;\n    this.responseCallbacks[id].method = method;\n\n    var _this = this;\n\n    // schedule triggering the error response if a custom timeout is set\n    if (this._customTimeout) {\n        setTimeout(function () {\n            if (_this.responseCallbacks[id]) {\n                _this.responseCallbacks[id](errors.ConnectionTimeout(_this._customTimeout));\n                delete _this.responseCallbacks[id];\n            }\n        }, this._customTimeout);\n    }\n};\n\n/**\n Timeout all requests when the end/error event is fired\n\n @method _timeout\n */\nWebsocketProvider.prototype._timeout = function() {\n    for(var key in this.responseCallbacks) {\n        if(this.responseCallbacks.hasOwnProperty(key)){\n            this.responseCallbacks[key](errors.InvalidConnection('on WS'));\n            delete this.responseCallbacks[key];\n        }\n    }\n};\n\n\nWebsocketProvider.prototype.send = function (payload, callback) {\n    var _this = this;\n\n    if (this.connection.readyState === this.connection.CONNECTING) {\n        setTimeout(function () {\n            _this.send(payload, callback);\n        }, 10);\n        return;\n    }\n\n    // try reconnect, when connection is gone\n    // if(!this.connection.writable)\n    //     this.connection.connect({url: this.url});\n    if (this.connection.readyState !== this.connection.OPEN) {\n        console.error('connection not open on send()');\n        if (typeof this.connection.onerror === 'function') {\n            this.connection.onerror(new Error('connection not open'));\n        } else {\n            console.error('no error callback');\n        }\n        callback(new Error('connection not open'));\n        return;\n    }\n\n    this.connection.send(JSON.stringify(payload));\n    this._addResponseCallback(payload, callback);\n};\n\n/**\n Subscribes to provider events.provider\n\n @method on\n @param {String} type    'notifcation', 'connect', 'error', 'end' or 'data'\n @param {Function} callback   the callback to call\n */\nWebsocketProvider.prototype.on = function (type, callback) {\n\n    if(typeof callback !== 'function')\n        throw new Error('The second parameter callback must be a function.');\n\n    switch(type){\n        case 'data':\n            this.notificationCallbacks.push(callback);\n            break;\n\n        case 'connect':\n            this.connection.onopen = callback;\n            break;\n\n        case 'end':\n            this.connection.onclose = callback;\n            break;\n\n        case 'error':\n            this.connection.onerror = callback;\n            break;\n\n        // default:\n        //     this.connection.on(type, callback);\n        //     break;\n    }\n};\n\n// TODO add once\n\n/**\n Removes event listener\n\n @method removeListener\n @param {String} type    'notifcation', 'connect', 'error', 'end' or 'data'\n @param {Function} callback   the callback to call\n */\nWebsocketProvider.prototype.removeListener = function (type, callback) {\n    var _this = this;\n\n    switch(type){\n        case 'data':\n            this.notificationCallbacks.forEach(function(cb, index){\n                if(cb === callback)\n                    _this.notificationCallbacks.splice(index, 1);\n            });\n            break;\n\n        // TODO remvoving connect missing\n\n        // default:\n        //     this.connection.removeListener(type, callback);\n        //     break;\n    }\n};\n\n/**\n Removes all event listeners\n\n @method removeAllListeners\n @param {String} type    'notifcation', 'connect', 'error', 'end' or 'data'\n */\nWebsocketProvider.prototype.removeAllListeners = function (type) {\n    switch(type){\n        case 'data':\n            this.notificationCallbacks = [];\n            break;\n\n        // TODO remvoving connect properly missing\n\n        case 'connect':\n            this.connection.onopen = null;\n            break;\n\n        case 'end':\n            this.connection.onclose = null;\n            break;\n\n        case 'error':\n            this.connection.onerror = null;\n            break;\n\n        default:\n            // this.connection.removeAllListeners(type);\n            break;\n    }\n};\n\n/**\n Resets the providers, clears all callbacks\n\n @method reset\n */\nWebsocketProvider.prototype.reset = function () {\n    this._timeout();\n    this.notificationCallbacks = [];\n\n    // this.connection.removeAllListeners('error');\n    // this.connection.removeAllListeners('end');\n    // this.connection.removeAllListeners('timeout');\n\n    this.addDefaultEvents();\n};\n\nWebsocketProvider.prototype.disconnect = function () {\n    if (this.connection) {\n        this.connection.close();\n    }\n};\n\nmodule.exports = WebsocketProvider;\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA,IAAIA,CAAC,GAAGC,OAAO,CAAC,YAAD,CAAf;;AACA,IAAIC,MAAM,GAAGD,OAAO,CAAC,mBAAD,CAAP,CAA6BC,MAA1C;;AACA,IAAIC,EAAE,GAAGF,OAAO,CAAC,WAAD,CAAP,CAAqBG,YAA9B;;AAEA,IAAIC,MAAM,GAAGC,MAAM,CAACC,SAAP,CAAiBC,QAAjB,CAA0BC,IAA1B,CAA+B,OAAOC,OAAP,KAAmB,WAAnB,GAAiCA,OAAjC,GAA2C,CAA1E,MAAiF,kBAA9F;AAEA,IAAIC,KAAK,GAAG,IAAZ;AACA,IAAIC,QAAQ,GAAG,IAAf;;AACA,IAAIP,MAAJ,EAAY;EACRM,KAAK,GAAG,UAASE,GAAT,EAAc;IAClB,OAAOC,MAAM,CAACC,IAAP,CAAYF,GAAZ,EAAiBL,QAAjB,CAA0B,QAA1B,CAAP;EACH,CAFD;;EAGA,IAAIQ,GAAG,GAAGf,OAAO,CAAC,KAAD,CAAjB;;EACA,IAAIe,GAAG,CAACC,GAAR,EAAa;IACT;IACA,IAAIC,MAAM,GAAGF,GAAG,CAACC,GAAjB;;IACAL,QAAQ,GAAG,UAASI,GAAT,EAAc;MACrB,OAAO,IAAIE,MAAJ,CAAWF,GAAX,CAAP;IACH,CAFD;EAGH,CAND,MAOK;IACD;IACAJ,QAAQ,GAAGX,OAAO,CAAC,KAAD,CAAP,CAAekB,KAA1B;EACH;AACJ,CAhBD,MAgBO;EACHR,KAAK,GAAGS,IAAR;;EACAR,QAAQ,GAAG,UAASI,GAAT,EAAc;IACrB,OAAO,IAAIC,GAAJ,CAAQD,GAAR,CAAP;EACH,CAFD;AAGH,C,CACD;;;AAKA,IAAIK,iBAAiB,GAAG,SAASA,iBAAT,CAA2BL,GAA3B,EAAgCM,OAAhC,EAA0C;EAC9D,IAAI,CAACnB,EAAL,EAAS;IACL,MAAM,IAAIoB,KAAJ,CAAU,4BAAV,CAAN;EACH;;EAED,IAAIC,KAAK,GAAG,IAAZ;;EACA,KAAKC,iBAAL,GAAyB,EAAzB;EACA,KAAKC,qBAAL,GAA6B,EAA7B;EAEAJ,OAAO,GAAGA,OAAO,IAAI,EAArB;EACA,KAAKK,cAAL,GAAsBL,OAAO,CAACM,OAA9B,CAV8D,CAY9D;EACA;EACA;;EACA,IAAIC,SAAS,GAAGjB,QAAQ,CAACI,GAAD,CAAxB;EACA,IAAIc,OAAO,GAAGR,OAAO,CAACQ,OAAR,IAAmB,EAAjC;EACA,IAAIC,QAAQ,GAAGT,OAAO,CAACS,QAAR,IAAoBC,SAAnC;;EACA,IAAIH,SAAS,CAACI,QAAV,IAAsBJ,SAAS,CAACK,QAApC,EAA8C;IAC1CJ,OAAO,CAACK,aAAR,GAAwB,WAAWxB,KAAK,CAACkB,SAAS,CAACI,QAAV,GAAqB,GAArB,GAA2BJ,SAAS,CAACK,QAAtC,CAAxC;EACH,CApB6D,CAsB9D;;;EACA,IAAIE,YAAY,GAAGd,OAAO,CAACc,YAAR,IAAwBJ,SAA3C,CAvB8D,CAyB9D;EACA;;EACA,IAAIK,cAAc,GAAGf,OAAO,CAACe,cAAR,IAA0BL,SAA/C,CA3B8D,CA6B9D;EACA;;EACA,IAAIH,SAAS,CAACS,IAAd,EAAoB;IAChBR,OAAO,CAACK,aAAR,GAAwB,WAAWxB,KAAK,CAACkB,SAAS,CAACS,IAAX,CAAxC;EACH;;EACD,KAAKC,UAAL,GAAkB,IAAIpC,EAAJ,CAAOa,GAAP,EAAYe,QAAZ,EAAsBC,SAAtB,EAAiCF,OAAjC,EAA0CO,cAA1C,EAA0DD,YAA1D,CAAlB;EAEA,KAAKI,gBAAL,GApC8D,CAuC9D;;EACA,KAAKD,UAAL,CAAgBE,SAAhB,GAA4B,UAASC,CAAT,EAAY;IACpC;IACA,IAAIC,IAAI,GAAI,OAAOD,CAAC,CAACC,IAAT,KAAkB,QAAnB,GAA+BD,CAAC,CAACC,IAAjC,GAAwC,EAAnD;;IAEAnB,KAAK,CAACoB,cAAN,CAAqBD,IAArB,EAA2BE,OAA3B,CAAmC,UAASC,MAAT,EAAgB;MAE/C,IAAIC,EAAE,GAAG,IAAT,CAF+C,CAI/C;;MACA,IAAG/C,CAAC,CAACgD,OAAF,CAAUF,MAAV,CAAH,EAAsB;QAClBA,MAAM,CAACD,OAAP,CAAe,UAASI,IAAT,EAAc;UACzB,IAAGzB,KAAK,CAACC,iBAAN,CAAwBwB,IAAI,CAACF,EAA7B,CAAH,EACIA,EAAE,GAAGE,IAAI,CAACF,EAAV;QACP,CAHD;MAIH,CALD,MAKO;QACHA,EAAE,GAAGD,MAAM,CAACC,EAAZ;MACH,CAZ8C,CAc/C;;;MACA,IAAG,CAACA,EAAD,IAAOD,MAAP,IAAiBA,MAAM,CAACI,MAAxB,IAAkCJ,MAAM,CAACI,MAAP,CAAcC,OAAd,CAAsB,eAAtB,MAA2C,CAAC,CAAjF,EAAoF;QAChF3B,KAAK,CAACE,qBAAN,CAA4BmB,OAA5B,CAAoC,UAASO,QAAT,EAAkB;UAClD,IAAGpD,CAAC,CAACqD,UAAF,CAAaD,QAAb,CAAH,EACIA,QAAQ,CAACN,MAAD,CAAR;QACP,CAHD,EADgF,CAMhF;;MACH,CAPD,MAOO,IAAGtB,KAAK,CAACC,iBAAN,CAAwBsB,EAAxB,CAAH,EAAgC;QACnCvB,KAAK,CAACC,iBAAN,CAAwBsB,EAAxB,EAA4B,IAA5B,EAAkCD,MAAlC;;QACA,OAAOtB,KAAK,CAACC,iBAAN,CAAwBsB,EAAxB,CAAP;MACH;IACJ,CA1BD;EA2BH,CA/BD,CAxC8D,CAyE9D;;;EACAzC,MAAM,CAACgD,cAAP,CAAsB,IAAtB,EAA4B,WAA5B,EAAyC;IACvCC,GAAG,EAAE,YAAY;MACf,OAAO,KAAKhB,UAAL,IAAmB,KAAKA,UAAL,CAAgBiB,UAAhB,KAA+B,KAAKjB,UAAL,CAAgBkB,IAAzE;IACD,CAHsC;IAIvCC,UAAU,EAAE;EAJ2B,CAAzC;AAMH,CAhFD;AAkFA;AACA;AACA;AACA;AACA;;;AACArC,iBAAiB,CAACd,SAAlB,CAA4BiC,gBAA5B,GAA+C,YAAU;EACrD,IAAIhB,KAAK,GAAG,IAAZ;;EAEA,KAAKe,UAAL,CAAgBoB,OAAhB,GAA0B,YAAU;IAChCnC,KAAK,CAACoC,QAAN;EACH,CAFD;;EAIA,KAAKrB,UAAL,CAAgBsB,OAAhB,GAA0B,YAAU;IAChCrC,KAAK,CAACoC,QAAN,GADgC,CAGhC;;;IACApC,KAAK,CAACsC,KAAN;EACH,CALD,CAPqD,CAcrD;EACA;EACA;;AACH,CAjBD;AAmBA;AACA;AACA;AACA;AACA;AACA;;;AACAzC,iBAAiB,CAACd,SAAlB,CAA4BqC,cAA5B,GAA6C,UAASD,IAAT,EAAe;EACxD,IAAInB,KAAK,GAAG,IAAZ;EAAA,IACIuC,YAAY,GAAG,EADnB,CADwD,CAIxD;;;EACA,IAAIC,aAAa,GAAGrB,IAAI,CACnBsB,OADe,CACP,cADO,EACQ,QADR,EACkB;EADlB,CAEfA,OAFe,CAEP,kBAFO,EAEY,UAFZ,EAEwB;EAFxB,CAGfA,OAHe,CAGP,gBAHO,EAGU,SAHV,EAGqB;EAHrB,CAIfA,OAJe,CAIP,gBAJO,EAIU,SAJV,EAIqB;EAJrB,CAKfC,KALe,CAKT,MALS,CAApB;EAOAF,aAAa,CAACnB,OAAd,CAAsB,UAASF,IAAT,EAAc;IAEhC;IACA,IAAGnB,KAAK,CAAC2C,SAAT,EACIxB,IAAI,GAAGnB,KAAK,CAAC2C,SAAN,GAAkBxB,IAAzB;IAEJ,IAAIG,MAAM,GAAG,IAAb;;IAEA,IAAI;MACAA,MAAM,GAAGsB,IAAI,CAACjD,KAAL,CAAWwB,IAAX,CAAT;IAEH,CAHD,CAGE,OAAMD,CAAN,EAAS;MAEPlB,KAAK,CAAC2C,SAAN,GAAkBxB,IAAlB,CAFO,CAIP;;MACA0B,YAAY,CAAC7C,KAAK,CAAC8C,gBAAP,CAAZ;MACA9C,KAAK,CAAC8C,gBAAN,GAAyBC,UAAU,CAAC,YAAU;QAC1C/C,KAAK,CAACoC,QAAN;;QACA,MAAM1D,MAAM,CAACsE,eAAP,CAAuB7B,IAAvB,CAAN;MACH,CAHkC,EAGhC,OAAO,EAHyB,CAAnC;MAKA;IACH,CAvB+B,CAyBhC;;;IACA0B,YAAY,CAAC7C,KAAK,CAAC8C,gBAAP,CAAZ;IACA9C,KAAK,CAAC2C,SAAN,GAAkB,IAAlB;IAEA,IAAGrB,MAAH,EACIiB,YAAY,CAACU,IAAb,CAAkB3B,MAAlB;EACP,CA/BD;EAiCA,OAAOiB,YAAP;AACH,CA9CD;AAiDA;AACA;AACA;AACA;AACA;AACA;;;AACA1C,iBAAiB,CAACd,SAAlB,CAA4BmE,oBAA5B,GAAmD,UAASC,OAAT,EAAkBvB,QAAlB,EAA4B;EAC3E,IAAIL,EAAE,GAAG4B,OAAO,CAAC5B,EAAR,IAAc4B,OAAO,CAAC,CAAD,CAAP,CAAW5B,EAAlC;EACA,IAAIG,MAAM,GAAGyB,OAAO,CAACzB,MAAR,IAAkByB,OAAO,CAAC,CAAD,CAAP,CAAWzB,MAA1C;EAEA,KAAKzB,iBAAL,CAAuBsB,EAAvB,IAA6BK,QAA7B;EACA,KAAK3B,iBAAL,CAAuBsB,EAAvB,EAA2BG,MAA3B,GAAoCA,MAApC;;EAEA,IAAI1B,KAAK,GAAG,IAAZ,CAP2E,CAS3E;;;EACA,IAAI,KAAKG,cAAT,EAAyB;IACrB4C,UAAU,CAAC,YAAY;MACnB,IAAI/C,KAAK,CAACC,iBAAN,CAAwBsB,EAAxB,CAAJ,EAAiC;QAC7BvB,KAAK,CAACC,iBAAN,CAAwBsB,EAAxB,EAA4B7C,MAAM,CAAC0E,iBAAP,CAAyBpD,KAAK,CAACG,cAA/B,CAA5B;;QACA,OAAOH,KAAK,CAACC,iBAAN,CAAwBsB,EAAxB,CAAP;MACH;IACJ,CALS,EAKP,KAAKpB,cALE,CAAV;EAMH;AACJ,CAlBD;AAoBA;AACA;AACA;AACA;AACA;;;AACAN,iBAAiB,CAACd,SAAlB,CAA4BqD,QAA5B,GAAuC,YAAW;EAC9C,KAAI,IAAIiB,GAAR,IAAe,KAAKpD,iBAApB,EAAuC;IACnC,IAAG,KAAKA,iBAAL,CAAuBqD,cAAvB,CAAsCD,GAAtC,CAAH,EAA8C;MAC1C,KAAKpD,iBAAL,CAAuBoD,GAAvB,EAA4B3E,MAAM,CAAC6E,iBAAP,CAAyB,OAAzB,CAA5B;MACA,OAAO,KAAKtD,iBAAL,CAAuBoD,GAAvB,CAAP;IACH;EACJ;AACJ,CAPD;;AAUAxD,iBAAiB,CAACd,SAAlB,CAA4ByE,IAA5B,GAAmC,UAAUL,OAAV,EAAmBvB,QAAnB,EAA6B;EAC5D,IAAI5B,KAAK,GAAG,IAAZ;;EAEA,IAAI,KAAKe,UAAL,CAAgBiB,UAAhB,KAA+B,KAAKjB,UAAL,CAAgB0C,UAAnD,EAA+D;IAC3DV,UAAU,CAAC,YAAY;MACnB/C,KAAK,CAACwD,IAAN,CAAWL,OAAX,EAAoBvB,QAApB;IACH,CAFS,EAEP,EAFO,CAAV;IAGA;EACH,CAR2D,CAU5D;EACA;EACA;;;EACA,IAAI,KAAKb,UAAL,CAAgBiB,UAAhB,KAA+B,KAAKjB,UAAL,CAAgBkB,IAAnD,EAAyD;IACrDyB,OAAO,CAACC,KAAR,CAAc,+BAAd;;IACA,IAAI,OAAO,KAAK5C,UAAL,CAAgBoB,OAAvB,KAAmC,UAAvC,EAAmD;MAC/C,KAAKpB,UAAL,CAAgBoB,OAAhB,CAAwB,IAAIpC,KAAJ,CAAU,qBAAV,CAAxB;IACH,CAFD,MAEO;MACH2D,OAAO,CAACC,KAAR,CAAc,mBAAd;IACH;;IACD/B,QAAQ,CAAC,IAAI7B,KAAJ,CAAU,qBAAV,CAAD,CAAR;IACA;EACH;;EAED,KAAKgB,UAAL,CAAgByC,IAAhB,CAAqBZ,IAAI,CAACgB,SAAL,CAAeT,OAAf,CAArB;;EACA,KAAKD,oBAAL,CAA0BC,OAA1B,EAAmCvB,QAAnC;AACH,CA1BD;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA/B,iBAAiB,CAACd,SAAlB,CAA4B8E,EAA5B,GAAiC,UAAUC,IAAV,EAAgBlC,QAAhB,EAA0B;EAEvD,IAAG,OAAOA,QAAP,KAAoB,UAAvB,EACI,MAAM,IAAI7B,KAAJ,CAAU,mDAAV,CAAN;;EAEJ,QAAO+D,IAAP;IACI,KAAK,MAAL;MACI,KAAK5D,qBAAL,CAA2B+C,IAA3B,CAAgCrB,QAAhC;MACA;;IAEJ,KAAK,SAAL;MACI,KAAKb,UAAL,CAAgBgD,MAAhB,GAAyBnC,QAAzB;MACA;;IAEJ,KAAK,KAAL;MACI,KAAKb,UAAL,CAAgBsB,OAAhB,GAA0BT,QAA1B;MACA;;IAEJ,KAAK,OAAL;MACI,KAAKb,UAAL,CAAgBoB,OAAhB,GAA0BP,QAA1B;MACA;IAEJ;IACA;IACA;EAnBJ;AAqBH,CA1BD,C,CA4BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA/B,iBAAiB,CAACd,SAAlB,CAA4BiF,cAA5B,GAA6C,UAAUF,IAAV,EAAgBlC,QAAhB,EAA0B;EACnE,IAAI5B,KAAK,GAAG,IAAZ;;EAEA,QAAO8D,IAAP;IACI,KAAK,MAAL;MACI,KAAK5D,qBAAL,CAA2BmB,OAA3B,CAAmC,UAAS4C,EAAT,EAAaC,KAAb,EAAmB;QAClD,IAAGD,EAAE,KAAKrC,QAAV,EACI5B,KAAK,CAACE,qBAAN,CAA4BiE,MAA5B,CAAmCD,KAAnC,EAA0C,CAA1C;MACP,CAHD;MAIA;IAEJ;IAEA;IACA;IACA;EAZJ;AAcH,CAjBD;AAmBA;AACA;AACA;AACA;AACA;AACA;;;AACArE,iBAAiB,CAACd,SAAlB,CAA4BqF,kBAA5B,GAAiD,UAAUN,IAAV,EAAgB;EAC7D,QAAOA,IAAP;IACI,KAAK,MAAL;MACI,KAAK5D,qBAAL,GAA6B,EAA7B;MACA;IAEJ;;IAEA,KAAK,SAAL;MACI,KAAKa,UAAL,CAAgBgD,MAAhB,GAAyB,IAAzB;MACA;;IAEJ,KAAK,KAAL;MACI,KAAKhD,UAAL,CAAgBsB,OAAhB,GAA0B,IAA1B;MACA;;IAEJ,KAAK,OAAL;MACI,KAAKtB,UAAL,CAAgBoB,OAAhB,GAA0B,IAA1B;MACA;;IAEJ;MACI;MACA;EArBR;AAuBH,CAxBD;AA0BA;AACA;AACA;AACA;AACA;;;AACAtC,iBAAiB,CAACd,SAAlB,CAA4BuD,KAA5B,GAAoC,YAAY;EAC5C,KAAKF,QAAL;;EACA,KAAKlC,qBAAL,GAA6B,EAA7B,CAF4C,CAI5C;EACA;EACA;;EAEA,KAAKc,gBAAL;AACH,CATD;;AAWAnB,iBAAiB,CAACd,SAAlB,CAA4BsF,UAA5B,GAAyC,YAAY;EACjD,IAAI,KAAKtD,UAAT,EAAqB;IACjB,KAAKA,UAAL,CAAgBuD,KAAhB;EACH;AACJ,CAJD;;AAMAC,MAAM,CAACC,OAAP,GAAiB3E,iBAAjB"},"metadata":{},"sourceType":"script"}