{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mcnl\\\\Desktop\\\\gong\\\\SafetyManagement_UI\\\\client\\\\src\\\\App.jsx\",\n    _s = $RefreshSig$();\n\n// import React, { useEffect, useState } from \"react\";\n// import {FileUpload} from './components/FileUpload';\n// import \"./App.css\";\n// import TransactionContract from \"../src/contracts/Transaction.json\"\n// import Web3 from 'web3';\n// import moment from \"moment\";\n// import Axios from 'axios';\n// import Login from './login';\n// import Signup from './signup';\n// export default function App() {\n//   const [fileUrl, setFileUrl] = useState(\"\");\n//   const [web3, setWeb3] = useState(\"\");\n//   const [account, setAccount] = useState(\"\");\n//   const [transactionInstance, setTransactionInstance] = useState(\"\");\n//   const [loading, setLoading] = useState(false);\n//   const [category, setCategory] = useState(\"\");\n//   const [name, setName] = useState(\"\");\n//   const [ipfsHash, setIpfsHash] = useState(\"\");\n//   const [registrant, setRegsitrant] = useState(\"\");\n//   const [responsibleManager, setResponsibleManager] = useState(\"\");\n//   const [fileType, setFileType] = useState(\"\");\n//   const [fileDescription, setFileDescription] = useState(\"\");\n//   const [transactionCnt, setTransactionCnt] = useState(\"\");\n//   const [time, setTime] = useState(\"\");\n//   const [ipfsHash_, setIpfsHash_] = useState(\"\");\n//   const [category_, setCategory_] = useState(\"\");\n//   const [name_, setName_] = useState(\"\");\n//   const [registrant_, setRegsitrant_] = useState(\"\");\n//   const [responsibleManager_, setResponsibleManager_] = useState(\"\");\n//   const [fileType_, setFileType_] = useState(\"\");\n//   const [fileDescription_, setFileDescription_] = useState(\"\");\n//   const submitReview = ()=>{\n//     Axios.post('http://localhost:3001/api/insert', {\n//       category: category,\n//       name: name,\n//       time: time,\n//       ipfsHash: ipfsHash,\n//       registrant: registrant,\n//       responsible: responsibleManager,\n//       filetype: fileType,\n//       filedes: fileDescription\n//     }).then(()=>{\n//       alert('등록 완료!');\n//     })\n//   };\n//   useEffect(() => {\n//     async function componentWillMount(e) {\n//       const web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));\n//       setWeb3(web3);\n//       console.log(web3)\n//       const contract = require(\"truffle-contract\");\n//       const transaction = contract(TransactionContract);\n//       console.log(web3);\n//       transaction.setProvider(web3.currentProvider);\n//       web3.eth.getAccounts((error, accounts) => {\n//         if (!error){\n//           transaction.deployed().then(instance => {\n//             setTransactionInstance(instance);\n//             setAccount(accounts[0]);\n//             setLoading(true);\n//           })\n//         }\n//       })\n//     }\n//     componentWillMount();\n//     // setTimeout(() => {  console.log(\"World!\"); }, 1000);\n//     // updateAllTransactions();\n//   }, []);\n//   useEffect(() => {\n//     async function updateAllTransactions(e){\n//       let events = await transactionInstance.getPastEvents('handleTransaction', {fromBlock:0, toBlock:'latest'});\n//       for(let i=0; i<events.length; i+=1){\n//         const record = {};\n//         var time_ = moment.unix(events[i].returnValues.time);\n//         setCategory_(events[i].returnValues.category.toString());\n//         setName_(events[i].returnValues.name.toString());\n//         setTime(time_.toString());\n//         setIpfsHash_(events[i].returnValues.ipfs_hash.toString());\n//         setRegsitrant_(events[i].returnValues.registrant.toString());\n//         setResponsibleManager_(events[i].returnValues.responsible_manager.toString());\n//         setFileType_(events[i].returnValues.file_type.toString());\n//         setFileDescription_(events[i].returnValues.file_description.toString());\n//         setTransactionCnt(transactionInstance.cntTransactions());\n//         console.log(events[i].returnValues);\n//       }\n//       console.log(events.length);\n//       console.log(events);\n//     }\n//     if (loading == true) updateAllTransactions();\n// }, [loading]);\n//   const sendTransaction = async (e) => {\n//     console.log(web3);\n//     console.log(account);\n//     console.log(transactionInstance);\n//     await transactionInstance.sendTrans(category, name, ipfsHash, registrant, responsibleManager, fileType, fileDescription,{\n//       from: account,\n//       //value: e.web3.utils.toWei('10', \"ether\"),\n//       gas: 1000000\n//     })\n//     let events = await transactionInstance.getPastEvents('handleTransaction', {fromBlock: 0, toBlock:'latest'});\n//     console.log(events[events.length-1].transactionHash)\n//     //this.updateAllTransactions();\n//     submitReview();\n//   }\n//   return (\n//     <div>\n//       <Login />\n//       <Signup />\n//       <input type=\"text\" placeholder=\"Type\" onChange = {(event) => setCategory(event.target.value)}></input>\n//       <br></br>\n//       <input type=\"text\" placeholder=\"Name\" onChange = {(event) => setName(event.target.value)}></input>\n//       <br></br>\n//       <input type=\"text\" placeholder=\"Registrant\" onChange = {(event) => setRegsitrant(event.target.value)}></input>\n//       <br></br>\n//       <input type=\"text\" placeholder=\"Responsible Manager\" onChange = {(event) => setResponsibleManager(event.target.value)}></input>\n//       <br></br>\n//       <input type=\"text\" placeholder=\"File Type\" onChange = {(event) => setFileType(event.target.value)}></input>\n//       <br></br>\n//       <input type=\"text\" placeholder=\"File Description\" onChange = {(event) => setFileDescription(event.target.value)}></input>\n//       <br></br>\n//       <FileUpload setUrl={setFileUrl} setIpfs={setIpfsHash} />\n//       FileUrl :{\" \"}\n//       <a href={fileUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n//         {fileUrl}\n//       </a>\n//       <br></br>\n//       <p>Your account: {account}</p>\n//       <br></br>\n//       <button onClick={sendTransaction}>\n//         트랜잭션 추가\n//       </button>\n//       {/* <button onClick={updateAllTransactions}>\n//         트랜잭션 보여주기\n//       </button> */}\n//       <br></br>\n//       <p>all transactions:</p>\n//       <br></br>\n//       <p>Category: {category_}</p>\n//       <p>File Name: {name_}</p>\n//       <p>Time: {time}</p>\n//       <p>IPFS Hash: {ipfsHash_}</p>\n//       <p>Registrant: {registrant_}</p>\n//       <p>Responsible Manager: {responsibleManager_}</p>\n//       <p>File Type: {fileType_}</p>\n//       <p>File Description: {fileDescription_}</p>\n//     </div>\n//   )\n// }\nimport React, { useRef, useEffect, useState } from \"react\";\nimport { Route, Routes, Navigate } from \"react-router-dom\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport \"./styles/shards-dashboards.1.1.0.min.css\";\nimport Ray from \"./components/pages/Ray\";\nimport MainSidebar from \"./components/layout/MainSidebar/MainSidebar\";\nimport CCTV from \"./components/pages/CCTV\";\nimport All from \"./components/pages/All\";\nimport Pressure from \"./components/pages/Pressure\";\nimport Temp from \"./components/pages/Temp\";\nimport CheckList from \"./components/pages/CheckList\";\nimport Documents from \"./components/pages/Documents\";\nimport { Container, Row, Col } from \"shards-react\";\nimport MainNavbar from \"./components/layout/MainNavbar/MainNavbar\";\nimport MainFooter from \"./components/layout/MainFooter\";\nimport WriteTransaction from \"./components/pages/WriteTransaction\";\nimport \"./App.css\";\nimport TransactionContract from \"../src/contracts/Transaction.json\";\nimport Web3 from 'web3';\nimport moment from \"moment\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function App() {\n  _s();\n\n  const [web3, setWeb3] = useState(\"\");\n  const [account, setAccount] = useState(\"\");\n  const [transactionInstance, setTransactionInstance] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [block_list, setblock_list] = useState([]);\n  useEffect(() => {\n    async function componentWillMount(e) {\n      const web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));\n      setWeb3(web3);\n      console.log(web3);\n\n      const contract = require(\"truffle-contract\");\n\n      const transaction = contract(TransactionContract);\n      console.log(web3);\n      transaction.setProvider(web3.currentProvider);\n      web3.eth.getAccounts((error, accounts) => {\n        if (!error) {\n          transaction.deployed().then(instance => {\n            setTransactionInstance(instance);\n            setAccount(accounts[0]);\n            setLoading(true);\n          });\n        }\n      });\n    }\n\n    componentWillMount();\n  }, []);\n  const nextId = useRef(1);\n  useEffect(() => {\n    async function updateAllTransactions(e) {\n      let events = await transactionInstance.getPastEvents('handleTransaction', {\n        fromBlock: 0,\n        toBlock: 'latest'\n      });\n\n      for (let i = 0; i < events.length; i += 1) {\n        var time_ = moment.unix(events[i].returnValues.time);\n        block_list.push({\n          id: nextId.current,\n          category: events[i].returnValues.category.toString(),\n          name: events[i].returnValues.name.toString(),\n          time: time_.toString(),\n          ipfsHash: events[i].returnValues.ipfs_hash.toString(),\n          registrant: events[i].returnValues.registrant.toString(),\n          responsible: events[i].returnValues.responsible_manager.toString(),\n          filetype: events[i].returnValues.file_type.toString(),\n          filedes: events[i].returnValues.file_description.toString()\n        });\n        nextId.current += 1;\n        console.log(events[i].returnValues);\n      }\n\n      console.log('events.length = ', events.length);\n      console.log(events);\n      console.log('block_list = ', block_list);\n    }\n\n    if (loading == true) updateAllTransactions();\n  }, [loading]);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    fluid: true,\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      children: [/*#__PURE__*/_jsxDEV(MainSidebar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        className: \"main-content p-0\",\n        lg: {\n          size: 10,\n          offset: 2\n        },\n        md: {\n          size: 9,\n          offset: 3\n        },\n        sm: \"12\",\n        tag: \"main\",\n        children: [/*#__PURE__*/_jsxDEV(MainNavbar, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 14\n        }, this), /*#__PURE__*/_jsxDEV(Routes, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/\",\n            element: /*#__PURE__*/_jsxDEV(Navigate, {\n              to: \"/all\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 40\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/all\",\n            element: /*#__PURE__*/_jsxDEV(All, {\n              block_list: block_list\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 307,\n              columnNumber: 43\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/cctv\",\n            element: /*#__PURE__*/_jsxDEV(CCTV, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 308,\n              columnNumber: 44\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/documents\",\n            element: /*#__PURE__*/_jsxDEV(Documents, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 49\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/checklist\",\n            element: /*#__PURE__*/_jsxDEV(CheckList, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 49\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/temp\",\n            element: /*#__PURE__*/_jsxDEV(Temp, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 44\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/pressure\",\n            element: /*#__PURE__*/_jsxDEV(Pressure, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 48\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/ray\",\n            element: /*#__PURE__*/_jsxDEV(Ray, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 43\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 313,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/writetransaction\",\n            element: /*#__PURE__*/_jsxDEV(WriteTransaction, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 56\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(MainFooter, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 14\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 293,\n    columnNumber: 7\n  }, this);\n}\n\n_s(App, \"8xlPVEoyBiwLJbJVPKT1Pgk33dk=\");\n\n_c = App;\n;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useRef","useEffect","useState","Route","Routes","Navigate","Ray","MainSidebar","CCTV","All","Pressure","Temp","CheckList","Documents","Container","Row","Col","MainNavbar","MainFooter","WriteTransaction","TransactionContract","Web3","moment","App","web3","setWeb3","account","setAccount","transactionInstance","setTransactionInstance","loading","setLoading","block_list","setblock_list","componentWillMount","e","providers","HttpProvider","console","log","contract","require","transaction","setProvider","currentProvider","eth","getAccounts","error","accounts","deployed","then","instance","nextId","updateAllTransactions","events","getPastEvents","fromBlock","toBlock","i","length","time_","unix","returnValues","time","push","id","current","category","toString","name","ipfsHash","ipfs_hash","registrant","responsible","responsible_manager","filetype","file_type","filedes","file_description","size","offset"],"sources":["C:/Users/mcnl/Desktop/gong/SafetyManagement_UI/client/src/App.jsx"],"sourcesContent":["// import React, { useEffect, useState } from \"react\";\r\n// import {FileUpload} from './components/FileUpload';\r\n// import \"./App.css\";\r\n// import TransactionContract from \"../src/contracts/Transaction.json\"\r\n// import Web3 from 'web3';\r\n// import moment from \"moment\";\r\n// import Axios from 'axios';\r\n// import Login from './login';\r\n// import Signup from './signup';\r\n\r\n\r\n\r\n// export default function App() {\r\n//   const [fileUrl, setFileUrl] = useState(\"\");\r\n//   const [web3, setWeb3] = useState(\"\");\r\n//   const [account, setAccount] = useState(\"\");\r\n//   const [transactionInstance, setTransactionInstance] = useState(\"\");\r\n//   const [loading, setLoading] = useState(false);\r\n\r\n//   const [category, setCategory] = useState(\"\");\r\n//   const [name, setName] = useState(\"\");\r\n//   const [ipfsHash, setIpfsHash] = useState(\"\");\r\n//   const [registrant, setRegsitrant] = useState(\"\");\r\n//   const [responsibleManager, setResponsibleManager] = useState(\"\");\r\n//   const [fileType, setFileType] = useState(\"\");\r\n//   const [fileDescription, setFileDescription] = useState(\"\");\r\n//   const [transactionCnt, setTransactionCnt] = useState(\"\");\r\n\r\n//   const [time, setTime] = useState(\"\");\r\n//   const [ipfsHash_, setIpfsHash_] = useState(\"\");\r\n//   const [category_, setCategory_] = useState(\"\");\r\n//   const [name_, setName_] = useState(\"\");\r\n//   const [registrant_, setRegsitrant_] = useState(\"\");\r\n//   const [responsibleManager_, setResponsibleManager_] = useState(\"\");\r\n//   const [fileType_, setFileType_] = useState(\"\");\r\n//   const [fileDescription_, setFileDescription_] = useState(\"\");\r\n\r\n//   const submitReview = ()=>{\r\n//     Axios.post('http://localhost:3001/api/insert', {\r\n//       category: category,\r\n//       name: name,\r\n//       time: time,\r\n//       ipfsHash: ipfsHash,\r\n//       registrant: registrant,\r\n//       responsible: responsibleManager,\r\n//       filetype: fileType,\r\n//       filedes: fileDescription\r\n//     }).then(()=>{\r\n//       alert('등록 완료!');\r\n//     })\r\n//   };\r\n\r\n\r\n//   useEffect(() => {\r\n//     async function componentWillMount(e) {\r\n//       const web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));\r\n//       setWeb3(web3);\r\n//       console.log(web3)\r\n//       const contract = require(\"truffle-contract\");\r\n//       const transaction = contract(TransactionContract);\r\n//       console.log(web3);\r\n//       transaction.setProvider(web3.currentProvider);\r\n  \r\n//       web3.eth.getAccounts((error, accounts) => {\r\n//         if (!error){\r\n//           transaction.deployed().then(instance => {\r\n//             setTransactionInstance(instance);\r\n//             setAccount(accounts[0]);\r\n//             setLoading(true);\r\n//           })\r\n//         }\r\n//       })\r\n      \r\n//     }\r\n\r\n//     componentWillMount();\r\n//     // setTimeout(() => {  console.log(\"World!\"); }, 1000);\r\n//     // updateAllTransactions();\r\n\r\n    \r\n\r\n//   }, []);\r\n\r\n\r\n//   useEffect(() => {\r\n\r\n//     async function updateAllTransactions(e){\r\n//       let events = await transactionInstance.getPastEvents('handleTransaction', {fromBlock:0, toBlock:'latest'});\r\n//       for(let i=0; i<events.length; i+=1){\r\n//         const record = {};\r\n//         var time_ = moment.unix(events[i].returnValues.time);\r\n\r\n//         setCategory_(events[i].returnValues.category.toString());\r\n//         setName_(events[i].returnValues.name.toString());\r\n//         setTime(time_.toString());\r\n//         setIpfsHash_(events[i].returnValues.ipfs_hash.toString());\r\n//         setRegsitrant_(events[i].returnValues.registrant.toString());\r\n//         setResponsibleManager_(events[i].returnValues.responsible_manager.toString());\r\n//         setFileType_(events[i].returnValues.file_type.toString());\r\n//         setFileDescription_(events[i].returnValues.file_description.toString());\r\n//         setTransactionCnt(transactionInstance.cntTransactions());\r\n//         console.log(events[i].returnValues);\r\n//       }\r\n//       console.log(events.length);\r\n//       console.log(events);\r\n  \r\n//     }\r\n\r\n//     if (loading == true) updateAllTransactions();\r\n\r\n// }, [loading]);\r\n\r\n\r\n//   const sendTransaction = async (e) => {\r\n//     console.log(web3);\r\n//     console.log(account);\r\n//     console.log(transactionInstance);\r\n//     await transactionInstance.sendTrans(category, name, ipfsHash, registrant, responsibleManager, fileType, fileDescription,{\r\n//       from: account,\r\n//       //value: e.web3.utils.toWei('10', \"ether\"),\r\n//       gas: 1000000\r\n//     })\r\n    \r\n//     let events = await transactionInstance.getPastEvents('handleTransaction', {fromBlock: 0, toBlock:'latest'});\r\n//     console.log(events[events.length-1].transactionHash)\r\n//     //this.updateAllTransactions();\r\n\r\n//     submitReview();\r\n//   }\r\n\r\n\r\n\r\n\r\n//   return (\r\n//     <div>\r\n//       <Login />\r\n//       <Signup />\r\n//       <input type=\"text\" placeholder=\"Type\" onChange = {(event) => setCategory(event.target.value)}></input>\r\n//       <br></br>\r\n//       <input type=\"text\" placeholder=\"Name\" onChange = {(event) => setName(event.target.value)}></input>\r\n//       <br></br>\r\n//       <input type=\"text\" placeholder=\"Registrant\" onChange = {(event) => setRegsitrant(event.target.value)}></input>\r\n//       <br></br>\r\n//       <input type=\"text\" placeholder=\"Responsible Manager\" onChange = {(event) => setResponsibleManager(event.target.value)}></input>\r\n//       <br></br>\r\n//       <input type=\"text\" placeholder=\"File Type\" onChange = {(event) => setFileType(event.target.value)}></input>\r\n//       <br></br>\r\n//       <input type=\"text\" placeholder=\"File Description\" onChange = {(event) => setFileDescription(event.target.value)}></input>\r\n//       <br></br>\r\n      \r\n//       <FileUpload setUrl={setFileUrl} setIpfs={setIpfsHash} />\r\n//       FileUrl :{\" \"}\r\n//       <a href={fileUrl} target=\"_blank\" rel=\"noopener noreferrer\">\r\n//         {fileUrl}\r\n//       </a>\r\n//       <br></br>\r\n\r\n//       <p>Your account: {account}</p>\r\n//       <br></br>\r\n\r\n//       <button onClick={sendTransaction}>\r\n//         트랜잭션 추가\r\n//       </button>\r\n//       {/* <button onClick={updateAllTransactions}>\r\n//         트랜잭션 보여주기\r\n//       </button> */}\r\n//       <br></br>\r\n\r\n//       <p>all transactions:</p>\r\n//       <br></br>\r\n//       <p>Category: {category_}</p>\r\n//       <p>File Name: {name_}</p>\r\n//       <p>Time: {time}</p>\r\n//       <p>IPFS Hash: {ipfsHash_}</p>\r\n//       <p>Registrant: {registrant_}</p>\r\n//       <p>Responsible Manager: {responsibleManager_}</p>\r\n//       <p>File Type: {fileType_}</p>\r\n//       <p>File Description: {fileDescription_}</p>\r\n//     </div>\r\n//   )\r\n// }\r\n\r\n\r\n\r\n\r\n\r\nimport React, { useRef, useEffect, useState } from \"react\";\r\nimport { Route, Routes,  Navigate } from \"react-router-dom\";\r\n\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./styles/shards-dashboards.1.1.0.min.css\";\r\n\r\nimport Ray from \"./components/pages/Ray\";\r\nimport MainSidebar from \"./components/layout/MainSidebar/MainSidebar\";\r\nimport CCTV from \"./components/pages/CCTV\";\r\nimport All from \"./components/pages/All\";\r\nimport Pressure from \"./components/pages/Pressure\";\r\nimport Temp from \"./components/pages/Temp\";\r\nimport CheckList from \"./components/pages/CheckList\";\r\nimport Documents from \"./components/pages/Documents\";\r\n\r\nimport { Container, Row, Col } from \"shards-react\";\r\nimport MainNavbar from \"./components/layout/MainNavbar/MainNavbar\";\r\nimport MainFooter from \"./components/layout/MainFooter\";\r\n\r\nimport WriteTransaction from \"./components/pages/WriteTransaction\"\r\n\r\nimport \"./App.css\";\r\nimport TransactionContract from \"../src/contracts/Transaction.json\"\r\nimport Web3 from 'web3';\r\nimport moment from \"moment\";\r\n\r\nexport default function App() {\r\n  \r\n\r\n  const [web3, setWeb3] = useState(\"\");\r\n  const [account, setAccount] = useState(\"\");\r\n  const [transactionInstance, setTransactionInstance] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n  \r\n  const [block_list, setblock_list] = useState([]);\r\n\r\n  useEffect(() => {\r\n    async function componentWillMount(e) {\r\n      const web3 = new Web3(new Web3.providers.HttpProvider('http://localhost:8545'));\r\n      setWeb3(web3);\r\n      console.log(web3)\r\n      const contract = require(\"truffle-contract\");\r\n      const transaction = contract(TransactionContract);\r\n      console.log(web3);\r\n      transaction.setProvider(web3.currentProvider);\r\n  \r\n      web3.eth.getAccounts((error, accounts) => {\r\n        if (!error){\r\n          transaction.deployed().then(instance => {\r\n            setTransactionInstance(instance);\r\n            setAccount(accounts[0]);\r\n            setLoading(true);\r\n          })\r\n        }\r\n      })\r\n      \r\n    }\r\n\r\n    componentWillMount();    \r\n\r\n  }, []);\r\n\r\n  const nextId = useRef(1);\r\n\r\n  \r\n\r\n  useEffect(() => {\r\n\r\n    async function updateAllTransactions(e){\r\n      let events = await transactionInstance.getPastEvents('handleTransaction', {fromBlock:0, toBlock:'latest'});\r\n      \r\n\r\n\r\n      for(let i = 0; i < events.length; i += 1){\r\n        \r\n        var time_ = moment.unix(events[i].returnValues.time);\r\n        \r\n        block_list.push({\r\n          id: nextId.current,\r\n          category : events[i].returnValues.category.toString(),\r\n          name : events[i].returnValues.name.toString(),\r\n          time : time_.toString(), \r\n          ipfsHash : events[i].returnValues.ipfs_hash.toString(),\r\n          registrant : events[i].returnValues.registrant.toString(),\r\n          responsible : events[i].returnValues.responsible_manager.toString(),\r\n          filetype : events[i].returnValues.file_type.toString(),\r\n          filedes : events[i].returnValues.file_description.toString()\r\n        }\r\n        )\r\n        \r\n        nextId.current += 1;\r\n\r\n        console.log(events[i].returnValues);\r\n      }\r\n      console.log('events.length = ', events.length);\r\n      console.log(events);\r\n      console.log('block_list = ', block_list);\r\n  \r\n    }\r\n\r\n    if (loading == true) updateAllTransactions();\r\n\r\n}, [loading]);\r\n\r\n\r\n  return(\r\n      <Container fluid>\r\n        <Row>\r\n          <MainSidebar/>\r\n          <Col\r\n            className=\"main-content p-0\"\r\n            lg={{ size: 10, offset: 2 }}\r\n            md={{ size: 9, offset: 3 }}\r\n            sm=\"12\"\r\n            tag=\"main\"\r\n          >\r\n            {<MainNavbar />}\r\n            <Routes>\r\n              {/* <Route path=\"/\" element={<All/>} /> */}\r\n              <Route path=\"/\" element={<Navigate to=\"/all\"/>} />\r\n              <Route path=\"/all\" element={<All block_list={block_list}/>} />\r\n              <Route path=\"/cctv\" element={<CCTV/>} />\r\n              <Route path=\"/documents\" element={<Documents/>} />\r\n              <Route path=\"/checklist\" element={<CheckList/>} />\r\n              <Route path=\"/temp\" element={<Temp/>} />\r\n              <Route path=\"/pressure\" element={<Pressure/>} />\r\n              <Route path=\"/ray\" element={<Ray/>} />\r\n              <Route path=\"/writetransaction\" element={<WriteTransaction />}/>\r\n            </Routes>\r\n            {<MainFooter />}\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n\r\n  )\r\n};"],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAIA;AAGA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA,OAAOA,KAAP,IAAgBC,MAAhB,EAAwBC,SAAxB,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,SAASC,KAAT,EAAgBC,MAAhB,EAAyBC,QAAzB,QAAyC,kBAAzC;AAEA,OAAO,sCAAP;AACA,OAAO,0CAAP;AAEA,OAAOC,GAAP,MAAgB,wBAAhB;AACA,OAAOC,WAAP,MAAwB,6CAAxB;AACA,OAAOC,IAAP,MAAiB,yBAAjB;AACA,OAAOC,GAAP,MAAgB,wBAAhB;AACA,OAAOC,QAAP,MAAqB,6BAArB;AACA,OAAOC,IAAP,MAAiB,yBAAjB;AACA,OAAOC,SAAP,MAAsB,8BAAtB;AACA,OAAOC,SAAP,MAAsB,8BAAtB;AAEA,SAASC,SAAT,EAAoBC,GAApB,EAAyBC,GAAzB,QAAoC,cAApC;AACA,OAAOC,UAAP,M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"},"metadata":{},"sourceType":"module"}