{"ast":null,"code":"var parseKeys = require('parse-asn1');\n\nvar randomBytes = require('randombytes');\n\nvar createHash = require('create-hash');\n\nvar mgf = require('./mgf');\n\nvar xor = require('./xor');\n\nvar BN = require('bn.js');\n\nvar withPublic = require('./withPublic');\n\nvar crt = require('browserify-rsa');\n\nvar Buffer = require('safe-buffer').Buffer;\n\nmodule.exports = function publicEncrypt(publicKey, msg, reverse) {\n  var padding;\n\n  if (publicKey.padding) {\n    padding = publicKey.padding;\n  } else if (reverse) {\n    padding = 1;\n  } else {\n    padding = 4;\n  }\n\n  var key = parseKeys(publicKey);\n  var paddedMsg;\n\n  if (padding === 4) {\n    paddedMsg = oaep(key, msg);\n  } else if (padding === 1) {\n    paddedMsg = pkcs1(key, msg, reverse);\n  } else if (padding === 3) {\n    paddedMsg = new BN(msg);\n\n    if (paddedMsg.cmp(key.modulus) >= 0) {\n      throw new Error('data too long for modulus');\n    }\n  } else {\n    throw new Error('unknown padding');\n  }\n\n  if (reverse) {\n    return crt(paddedMsg, key);\n  } else {\n    return withPublic(paddedMsg, key);\n  }\n};\n\nfunction oaep(key, msg) {\n  var k = key.modulus.byteLength();\n  var mLen = msg.length;\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest();\n  var hLen = iHash.length;\n  var hLen2 = 2 * hLen;\n\n  if (mLen > k - hLen2 - 2) {\n    throw new Error('message too long');\n  }\n\n  var ps = Buffer.alloc(k - mLen - hLen2 - 2);\n  var dblen = k - hLen - 1;\n  var seed = randomBytes(hLen);\n  var maskedDb = xor(Buffer.concat([iHash, ps, Buffer.alloc(1, 1), msg], dblen), mgf(seed, dblen));\n  var maskedSeed = xor(seed, mgf(maskedDb, hLen));\n  return new BN(Buffer.concat([Buffer.alloc(1), maskedSeed, maskedDb], k));\n}\n\nfunction pkcs1(key, msg, reverse) {\n  var mLen = msg.length;\n  var k = key.modulus.byteLength();\n\n  if (mLen > k - 11) {\n    throw new Error('message too long');\n  }\n\n  var ps;\n\n  if (reverse) {\n    ps = Buffer.alloc(k - mLen - 3, 0xff);\n  } else {\n    ps = nonZero(k - mLen - 3);\n  }\n\n  return new BN(Buffer.concat([Buffer.from([0, reverse ? 1 : 2]), ps, Buffer.alloc(1), msg], k));\n}\n\nfunction nonZero(len) {\n  var out = Buffer.allocUnsafe(len);\n  var i = 0;\n  var cache = randomBytes(len * 2);\n  var cur = 0;\n  var num;\n\n  while (i < len) {\n    if (cur === cache.length) {\n      cache = randomBytes(len * 2);\n      cur = 0;\n    }\n\n    num = cache[cur++];\n\n    if (num) {\n      out[i++] = num;\n    }\n  }\n\n  return out;\n}","map":{"version":3,"names":["parseKeys","require","randomBytes","createHash","mgf","xor","BN","withPublic","crt","Buffer","module","exports","publicEncrypt","publicKey","msg","reverse","padding","key","paddedMsg","oaep","pkcs1","cmp","modulus","Error","k","byteLength","mLen","length","iHash","update","alloc","digest","hLen","hLen2","ps","dblen","seed","maskedDb","concat","maskedSeed","nonZero","from","len","out","allocUnsafe","i","cache","cur","num"],"sources":["C:/Users/mcnl/Desktop/gong/BlockchainSafetyManagement/client/node_modules/public-encrypt/publicEncrypt.js"],"sourcesContent":["var parseKeys = require('parse-asn1')\r\nvar randomBytes = require('randombytes')\r\nvar createHash = require('create-hash')\r\nvar mgf = require('./mgf')\r\nvar xor = require('./xor')\r\nvar BN = require('bn.js')\r\nvar withPublic = require('./withPublic')\r\nvar crt = require('browserify-rsa')\r\nvar Buffer = require('safe-buffer').Buffer\r\n\r\nmodule.exports = function publicEncrypt (publicKey, msg, reverse) {\r\n  var padding\r\n  if (publicKey.padding) {\r\n    padding = publicKey.padding\r\n  } else if (reverse) {\r\n    padding = 1\r\n  } else {\r\n    padding = 4\r\n  }\r\n  var key = parseKeys(publicKey)\r\n  var paddedMsg\r\n  if (padding === 4) {\r\n    paddedMsg = oaep(key, msg)\r\n  } else if (padding === 1) {\r\n    paddedMsg = pkcs1(key, msg, reverse)\r\n  } else if (padding === 3) {\r\n    paddedMsg = new BN(msg)\r\n    if (paddedMsg.cmp(key.modulus) >= 0) {\r\n      throw new Error('data too long for modulus')\r\n    }\r\n  } else {\r\n    throw new Error('unknown padding')\r\n  }\r\n  if (reverse) {\r\n    return crt(paddedMsg, key)\r\n  } else {\r\n    return withPublic(paddedMsg, key)\r\n  }\r\n}\r\n\r\nfunction oaep (key, msg) {\r\n  var k = key.modulus.byteLength()\r\n  var mLen = msg.length\r\n  var iHash = createHash('sha1').update(Buffer.alloc(0)).digest()\r\n  var hLen = iHash.length\r\n  var hLen2 = 2 * hLen\r\n  if (mLen > k - hLen2 - 2) {\r\n    throw new Error('message too long')\r\n  }\r\n  var ps = Buffer.alloc(k - mLen - hLen2 - 2)\r\n  var dblen = k - hLen - 1\r\n  var seed = randomBytes(hLen)\r\n  var maskedDb = xor(Buffer.concat([iHash, ps, Buffer.alloc(1, 1), msg], dblen), mgf(seed, dblen))\r\n  var maskedSeed = xor(seed, mgf(maskedDb, hLen))\r\n  return new BN(Buffer.concat([Buffer.alloc(1), maskedSeed, maskedDb], k))\r\n}\r\nfunction pkcs1 (key, msg, reverse) {\r\n  var mLen = msg.length\r\n  var k = key.modulus.byteLength()\r\n  if (mLen > k - 11) {\r\n    throw new Error('message too long')\r\n  }\r\n  var ps\r\n  if (reverse) {\r\n    ps = Buffer.alloc(k - mLen - 3, 0xff)\r\n  } else {\r\n    ps = nonZero(k - mLen - 3)\r\n  }\r\n  return new BN(Buffer.concat([Buffer.from([0, reverse ? 1 : 2]), ps, Buffer.alloc(1), msg], k))\r\n}\r\nfunction nonZero (len) {\r\n  var out = Buffer.allocUnsafe(len)\r\n  var i = 0\r\n  var cache = randomBytes(len * 2)\r\n  var cur = 0\r\n  var num\r\n  while (i < len) {\r\n    if (cur === cache.length) {\r\n      cache = randomBytes(len * 2)\r\n      cur = 0\r\n    }\r\n    num = cache[cur++]\r\n    if (num) {\r\n      out[i++] = num\r\n    }\r\n  }\r\n  return out\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}