{"ast":null,"code":"/*\r\n    This file is part of web3.js.\r\n    web3.js is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU Lesser General Public License as published by\r\n    the Free Software Foundation, either version 3 of the License, or\r\n    (at your option) any later version.\r\n    web3.js is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU Lesser General Public License for more details.\r\n    You should have received a copy of the GNU Lesser General Public License\r\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\r\n*/\n\n/**\r\n * @file Registry.js\r\n *\r\n * @author Samuel Furter <samuel@ethereum.org>\r\n * @date 2018\r\n */\n\"use strict\";\n\nvar _ = require('underscore');\n\nvar Contract = require('web3-eth-contract');\n\nvar namehash = require('eth-ens-namehash');\n\nvar PromiEvent = require('web3-core-promievent');\n\nvar REGISTRY_ABI = require('../ressources/ABI/Registry');\n\nvar RESOLVER_ABI = require('../ressources/ABI/Resolver');\n/**\r\n * A wrapper around the ENS registry contract.\r\n *\r\n * @method Registry\r\n * @param {Ens} ens\r\n * @constructor\r\n */\n\n\nfunction Registry(ens) {\n  var self = this;\n  this.ens = ens;\n  this.contract = ens.checkNetwork().then(function (address) {\n    var contract = new Contract(REGISTRY_ABI, address);\n    contract.setProvider(self.ens.eth.currentProvider);\n    return contract;\n  });\n}\n/**\r\n * Returns the address of the owner of an ENS name.\r\n *\r\n * @method owner\r\n * @param {string} name\r\n * @param {function} callback\r\n * @return {Promise<any>}\r\n */\n\n\nRegistry.prototype.owner = function (name, callback) {\n  var promiEvent = new PromiEvent(true);\n  this.contract.then(function (contract) {\n    contract.methods.owner(namehash.hash(name)).call().then(function (receipt) {\n      promiEvent.resolve(receipt);\n\n      if (_.isFunction(callback)) {\n        callback(receipt);\n      }\n    }).catch(function (error) {\n      promiEvent.reject(error);\n\n      if (_.isFunction(callback)) {\n        callback(error);\n      }\n    });\n  });\n  return promiEvent.eventEmitter;\n};\n/**\r\n * Returns the resolver contract associated with a name.\r\n *\r\n * @method resolver\r\n * @param {string} name\r\n * @return {Promise<Contract>}\r\n */\n\n\nRegistry.prototype.resolver = function (name) {\n  var self = this;\n  return this.contract.then(function (contract) {\n    return contract.methods.resolver(namehash.hash(name)).call();\n  }).then(function (address) {\n    var contract = new Contract(RESOLVER_ABI, address);\n    contract.setProvider(self.ens.eth.currentProvider);\n    return contract;\n  });\n};\n\nmodule.exports = Registry;","map":{"version":3,"names":["_","require","Contract","namehash","PromiEvent","REGISTRY_ABI","RESOLVER_ABI","Registry","ens","self","contract","checkNetwork","then","address","setProvider","eth","currentProvider","prototype","owner","name","callback","promiEvent","methods","hash","call","receipt","resolve","isFunction","catch","error","reject","eventEmitter","resolver","module","exports"],"sources":["D:/BlockchainSafetyManagement/client/node_modules/truffle-contract/node_modules/web3-eth-ens/src/contracts/Registry.js"],"sourcesContent":["/*\r\n    This file is part of web3.js.\r\n    web3.js is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU Lesser General Public License as published by\r\n    the Free Software Foundation, either version 3 of the License, or\r\n    (at your option) any later version.\r\n    web3.js is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU Lesser General Public License for more details.\r\n    You should have received a copy of the GNU Lesser General Public License\r\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\r\n*/\r\n/**\r\n * @file Registry.js\r\n *\r\n * @author Samuel Furter <samuel@ethereum.org>\r\n * @date 2018\r\n */\r\n\r\n\"use strict\";\r\n\r\nvar _ = require('underscore');\r\nvar Contract = require('web3-eth-contract');\r\nvar namehash = require('eth-ens-namehash');\r\nvar PromiEvent = require('web3-core-promievent');\r\nvar REGISTRY_ABI = require('../ressources/ABI/Registry');\r\nvar RESOLVER_ABI = require('../ressources/ABI/Resolver');\r\n\r\n\r\n/**\r\n * A wrapper around the ENS registry contract.\r\n *\r\n * @method Registry\r\n * @param {Ens} ens\r\n * @constructor\r\n */\r\nfunction Registry(ens) {\r\n    var self = this;\r\n    this.ens = ens;\r\n    this.contract = ens.checkNetwork().then(function (address) {\r\n        var contract = new Contract(REGISTRY_ABI, address);\r\n        contract.setProvider(self.ens.eth.currentProvider);\r\n\r\n        return contract;\r\n    });\r\n}\r\n\r\n/**\r\n * Returns the address of the owner of an ENS name.\r\n *\r\n * @method owner\r\n * @param {string} name\r\n * @param {function} callback\r\n * @return {Promise<any>}\r\n */\r\nRegistry.prototype.owner = function (name, callback) {\r\n    var promiEvent = new PromiEvent(true);\r\n\r\n    this.contract.then(function (contract) {\r\n        contract.methods.owner(namehash.hash(name)).call()\r\n            .then(function (receipt) {\r\n                promiEvent.resolve(receipt);\r\n\r\n                if (_.isFunction(callback)) {\r\n                    callback(receipt);\r\n                }\r\n            })\r\n            .catch(function (error) {\r\n                promiEvent.reject(error);\r\n\r\n                if (_.isFunction(callback)) {\r\n                    callback(error);\r\n                }\r\n            });\r\n    });\r\n\r\n    return promiEvent.eventEmitter;\r\n};\r\n\r\n/**\r\n * Returns the resolver contract associated with a name.\r\n *\r\n * @method resolver\r\n * @param {string} name\r\n * @return {Promise<Contract>}\r\n */\r\nRegistry.prototype.resolver = function (name) {\r\n    var self = this;\r\n\r\n    return this.contract.then(function (contract) {\r\n        return contract.methods.resolver(namehash.hash(name)).call();\r\n    }).then(function (address) {\r\n        var contract = new Contract(RESOLVER_ABI, address);\r\n        contract.setProvider(self.ens.eth.currentProvider);\r\n        return contract;\r\n    });\r\n};\r\n\r\nmodule.exports = Registry;\r\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AAEA,IAAIA,CAAC,GAAGC,OAAO,CAAC,YAAD,CAAf;;AACA,IAAIC,QAAQ,GAAGD,OAAO,CAAC,mBAAD,CAAtB;;AACA,IAAIE,QAAQ,GAAGF,OAAO,CAAC,kBAAD,CAAtB;;AACA,IAAIG,UAAU,GAAGH,OAAO,CAAC,sBAAD,CAAxB;;AACA,IAAII,YAAY,GAAGJ,OAAO,CAAC,4BAAD,CAA1B;;AACA,IAAIK,YAAY,GAAGL,OAAO,CAAC,4BAAD,CAA1B;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASM,QAAT,CAAkBC,GAAlB,EAAuB;EACnB,IAAIC,IAAI,GAAG,IAAX;EACA,KAAKD,GAAL,GAAWA,GAAX;EACA,KAAKE,QAAL,GAAgBF,GAAG,CAACG,YAAJ,GAAmBC,IAAnB,CAAwB,UAAUC,OAAV,EAAmB;IACvD,IAAIH,QAAQ,GAAG,IAAIR,QAAJ,CAAaG,YAAb,EAA2BQ,OAA3B,CAAf;IACAH,QAAQ,CAACI,WAAT,CAAqBL,IAAI,CAACD,GAAL,CAASO,GAAT,CAAaC,eAAlC;IAEA,OAAON,QAAP;EACH,CALe,CAAhB;AAMH;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAH,QAAQ,CAACU,SAAT,CAAmBC,KAAnB,GAA2B,UAAUC,IAAV,EAAgBC,QAAhB,EAA0B;EACjD,IAAIC,UAAU,GAAG,IAAIjB,UAAJ,CAAe,IAAf,CAAjB;EAEA,KAAKM,QAAL,CAAcE,IAAd,CAAmB,UAAUF,QAAV,EAAoB;IACnCA,QAAQ,CAACY,OAAT,CAAiBJ,KAAjB,CAAuBf,QAAQ,CAACoB,IAAT,CAAcJ,IAAd,CAAvB,EAA4CK,IAA5C,GACKZ,IADL,CACU,UAAUa,OAAV,EAAmB;MACrBJ,UAAU,CAACK,OAAX,CAAmBD,OAAnB;;MAEA,IAAIzB,CAAC,CAAC2B,UAAF,CAAaP,QAAb,CAAJ,EAA4B;QACxBA,QAAQ,CAACK,OAAD,CAAR;MACH;IACJ,CAPL,EAQKG,KARL,CAQW,UAAUC,KAAV,EAAiB;MACpBR,UAAU,CAACS,MAAX,CAAkBD,KAAlB;;MAEA,IAAI7B,CAAC,CAAC2B,UAAF,CAAaP,QAAb,CAAJ,EAA4B;QACxBA,QAAQ,CAACS,KAAD,CAAR;MACH;IACJ,CAdL;EAeH,CAhBD;EAkBA,OAAOR,UAAU,CAACU,YAAlB;AACH,CAtBD;AAwBA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACAxB,QAAQ,CAACU,SAAT,CAAmBe,QAAnB,GAA8B,UAAUb,IAAV,EAAgB;EAC1C,IAAIV,IAAI,GAAG,IAAX;EAEA,OAAO,KAAKC,QAAL,CAAcE,IAAd,CAAmB,UAAUF,QAAV,EAAoB;IAC1C,OAAOA,QAAQ,CAACY,OAAT,CAAiBU,QAAjB,CAA0B7B,QAAQ,CAACoB,IAAT,CAAcJ,IAAd,CAA1B,EAA+CK,IAA/C,EAAP;EACH,CAFM,EAEJZ,IAFI,CAEC,UAAUC,OAAV,EAAmB;IACvB,IAAIH,QAAQ,GAAG,IAAIR,QAAJ,CAAaI,YAAb,EAA2BO,OAA3B,CAAf;IACAH,QAAQ,CAACI,WAAT,CAAqBL,IAAI,CAACD,GAAL,CAASO,GAAT,CAAaC,eAAlC;IACA,OAAON,QAAP;EACH,CANM,CAAP;AAOH,CAVD;;AAYAuB,MAAM,CAACC,OAAP,GAAiB3B,QAAjB"},"metadata":{},"sourceType":"script"}